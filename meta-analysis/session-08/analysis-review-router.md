# Meta-Instruction Analysis: .cursor/ai-driven-workflow/review-protocols/utils/_review-router.md

## PHASE MAP
### Layer 1: System-Level Decisions
**Step 1:** Elevate the router as the centralized authority that mediates every review entrypoint before protocol execution.
- Reasoning: The opening mission statement declares the router as the fallback brain for the unified `/review` orchestrator and flags portfolio-dashboard optimization scope.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L1-L8ã€‘
- Meta-heuristic: Reinforces the deterministic orchestration spine mapped in the Process Tasks protocol by routing all executions through a single governance surface.ã€F:meta-analysis/session-04/analysis-3-process-tasks.mdâ€ L70-L98ã€‘

**Step 2:** Institute environment detection as the first gate so downstream selections inherit a validated capability context.
- Reasoning: Step 1 scripts a directory probe that toggles `CUSTOM_AVAILABLE`, printing explicit telemetry for whether tailored protocols exist.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L9-L22ã€‘
- Meta-heuristic: Mirrors the pre-flight gating pattern used in quick code reviewsâ€”confirming prerequisites before dispatching reviewers preserves audit reliability.ã€F:meta-analysis/session-06/analysis-code-review.mdâ€ L9-L17ã€‘

### Layer 2: Behavioral Control
**Step 1:** Encode per-protocol decision trees that privilege custom stacks but degrade gracefully to generics.
- Reasoning: Each `####` subsection repeats the conditional, preferring `custom_*` files when available and logging the chosen path for six review modes.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L24-L114ã€‘
- Meta-heuristic: Implements boundary guardianship by ensuring stack-specific heuristics only trigger when verified, preventing context bleed noted in prior design system reviews.ã€F:meta-analysis/session-07/analysis-design-system.mdâ€ L12-L23ã€‘

**Step 2:** Bind behavioral expectations to router-driven reporting so automation consumers receive uniform telemetry.
- Reasoning: The usage guidance mandates that adapters rely on the router and enumerates the four automated actions (detect, check, select, execute).ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L116-L132ã€‘
- Meta-heuristic: Sustains evidence-first reporting by guaranteeing every invocation emits consistent decision traces for retrospective telemetry loops.ã€F:meta-analysis/session-06/analysis-architecture-review.mdâ€ L58-L82ã€‘

### Layer 3: Procedural Logic
**Step 1:** Summarize routing permutations into a reference table that operationalizes mode-to-protocol bindings.
- Reasoning: The Router Logic Summary tabulates modes, custom sources, fallbacks, and stack features, encoding the algorithm in a human-scannable artifact.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L134-L144ã€‘
- Meta-heuristic: Procedural transparency converts branching logic into deterministic checklists aligned with the quality audit orchestrator.ã€F:.cursor/ai-driven-workflow/4-quality-audit.mdâ€ L22-L113ã€‘

**Step 2:** Close the execution loop with scripted usage samples that demonstrate router-mediated workflows.
- Reasoning: The Claude, Cursor, and result snippets show how commands resolve through the router and log the chosen custom asset before execution.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L168-L188ã€‘
- Meta-heuristic: Scenario anchoring provides reproducible scripts similar to the Process Tasks automation runbooks, ensuring operators can validate router outcomes end-to-end.ã€F:meta-analysis/session-04/analysis-3-process-tasks.mdâ€ L62-L89ã€‘

### Layer 4: Communication Grammar
**Step 1:** Maintain celebratory glyphs and severity cues to make routing state machine outputs instantly legible.
- Reasoning: Console echoes include `ğŸ¯`, `ğŸŒ`, and `âœ…` tokens describing decisions, reinforcing status semantics for human and machine parsing.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L32-L188ã€‘
- Meta-heuristic: Consistent glyph vocabulary keeps the communication grammar synchronized with severity cues defined in design and accessibility reviews, supporting router telemetry ingestion.ã€F:meta-analysis/session-07/analysis-ui-accessibility.mdâ€ L70-L99ã€‘

**Step 2:** Use emphatic bolding and Markdown callouts to highlight critical operator notes.
- Reasoning: Sections apply bold emphasis (e.g., `**IMPORTANT**`, `**Focus**`) to signal non-negotiable behaviors and the routerâ€™s mission.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L5-L192ã€‘
- Meta-heuristic: Marking must-read clauses upholds the communication discipline established across prior protocols, ensuring mission-critical instructions survive compression when summarized downstream.ã€F:meta-analysis/session-05/analysis-4-quality-audit.mdâ€ L80-L108ã€‘

## META-ARCHITECTURE DIAGRAM
```
System: Centralized Review Routerã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L1-L192ã€‘
â”œâ”€â”€ Subsystem A: Environment Capability Detectionã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L9-L22ã€‘
â”‚   â””â”€â”€ Rule A1: Toggle Custom Availability Telemetryã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L15-L21ã€‘
â”œâ”€â”€ Subsystem B: Protocol Selection Switchboardã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L24-L114ã€‘
â”‚   â”œâ”€â”€ Rule B1: Code Review Customâ†’Generic Cascadeã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L26-L39ã€‘
â”‚   â”œâ”€â”€ Rule B2: Security Check Customâ†’Generic Cascadeã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L41-L53ã€‘
â”‚   â”œâ”€â”€ Rule B3: Architecture Review Cascadeã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L56-L69ã€‘
â”‚   â”œâ”€â”€ Rule B4: Pre-Production Cascadeã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L71-L84ã€‘
â”‚   â”œâ”€â”€ Rule B5: Design System Cascadeã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L86-L99ã€‘
â”‚   â””â”€â”€ Rule B6: UI Accessibility Cascadeã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L101-L114ã€‘
â”œâ”€â”€ Subsystem C: Tool Adapter Contractã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L116-L132ã€‘
â”‚   â””â”€â”€ Rule C1: Four-Step Router Assurance Loopã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L127-L131ã€‘
â”œâ”€â”€ Subsystem D: Mode Reference Matrixã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L134-L144ã€‘
â”‚   â””â”€â”€ Rule D1: Modeâ†’Protocol Binding Tableã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L136-L144ã€‘
â””â”€â”€ Subsystem E: Operator Playbooks & Telemetry Outputã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L168-L192ã€‘
    â”œâ”€â”€ Rule E1: Adapter Invocation Examplesã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L168-L180ã€‘
    â””â”€â”€ Rule E2: Result Log Illustrationã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L182-L188ã€‘
```

## COMMENTARY
**Architectural Dependencies:**
- Environment detection (Subsystem A) sets the `CUSTOM_AVAILABLE` state consumed by every cascade in Subsystem B, ensuring selections respect real filesystem capabilities before branching.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L15-L114ã€‘
- The selection switchboard feeds the tool adapter contract (Subsystem C) so that downstream orchestrators can emit consistent telemetry, tying into the quality audit controller documented earlier.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L24-L132ã€‘ã€F:.cursor/ai-driven-workflow/4-quality-audit.mdâ€ L22-L113ã€‘
- The reference matrix (Subsystem D) and operator playbooks (Subsystem E) serve as human-facing projections of the same routing logic, enabling auditors to validate router decisions against recorded outputs.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L134-L192ã€‘

**Meta-Engineering Heuristics:**
- Deterministic routing: Every branch follows the same conditionals, preventing configuration drift across tools.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L24-L132ã€‘
- Graceful degradation: Custom logic is optional; the router promises seamless fallbacks, preserving reliability under constrained environments.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L32-L144ã€‘
- Evidence-first automation: Log messages and command snippets keep the routing process auditable for retrospective telemetry loops.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L32-L188ã€‘

**Cognitive Role Modularity:**
- Planner: Subsystem A verifies strategic capability assumptions before mode planning begins.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L9-L22ã€‘
- Executor: Subsystem B runs the operational cascades that determine which protocol executes.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L24-L114ã€‘
- Validator: Subsystem C enforces the four-step assurance loop, checking that routing behavior matches expectations.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L127-L131ã€‘
- Auditor: Subsystems D and E publish artifactsâ€”tables and logsâ€”that allow reviewers to audit routing choices post-execution.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L134-L192ã€‘

## INFERENCE SUMMARY
The router operationalizes a compliance-first selection framework characterized by:
1. Capability-aware gating that blocks protocol dispatch until environment assumptions are validated.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L9-L22ã€‘
2. Symmetric custom-to-generic cascades that preserve specialized intelligence without sacrificing portability.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L24-L114ã€‘
3. Telemetry-rich outputs that keep every routing decision observable for audit and retrospective loops.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L116-L192ã€‘

Design philosophy: deterministic orchestration with graceful degradationâ€”the router guarantees consistent behavior across heterogeneous environments while maintaining audit-ready transparency.ã€F:.cursor/ai-driven-workflow/review-protocols/utils/_review-router.mdâ€ L1-L192ã€‘ã€F:.cursor/ai-driven-workflow/4-quality-audit.mdâ€ L22-L113ã€‘

## OUTPUT INSTRUCTIONS
- Deliver this analysis in Markdown, preserving heading hierarchy and bullet indentation.
- Maintain ASCII diagram indentation exactly to support tooling ingestion.
- Retain line-referenced citations for every architectural claim to uphold traceability.
- Reuse router glyph vocabulary (`âœ…`, `ğŸ¯`, `ğŸŒ`) when summarizing behavior so telemetry semantics remain intact.
